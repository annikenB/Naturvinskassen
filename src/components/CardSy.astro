---
// Import MainLayout og evt. andre nødvendige Astro- eller Tailwind-komponenter
import MainLayout from "../layouts/MainLayout.astro";

const items = [
  { id: "hvid", name: "Hvid", count: 1 },
  { id: "rod", name: "Rød", count: 2 },
  { id: "orange", name: "Orange", count: 2 },
  { id: "rose", name: "Rose", count: 0 },
  { id: "bobler", name: "Bobler", count: 1 },
  { id: "suprise", name: "Suprise mig", count: 0 },
];

let totalCount = items.reduce((sum, item) => sum + item.count, 0);
---

<MainLayout>
  <h1>Skræddersy dit abonnement</h1>

  <section class="rounded-3xl p-4 m-40 bg-farvenavn-blaa">
    <div class="p-4">
      <h3 class="text-xl font-bold text-center">
        Din kasse Lige som du kan lide det
      </h3>
      <p>
        Tilføj de typer af naturvin som du ønsker i dit månedlige abonnement. Du
        vil modtage kassen pr. d. første hver måned. - Naturvin lige til døre!
      </p>
    </div>
    <div class="space-y-4 p-4">
      {
        items.map((item) => (
          <div class="flex items-center justify-between border-b-2 py-2">
            <span class="text-lg font-medium">{item.name}</span>
            <div class="flex items-center space-x-2">
              <button
                class="px-2 py-1 rounded bg-gray-200 hover:bg-gray-300"
                onClick={() => updateCount(item.id, -1)}
              >
                -
              </button>
              <span class="text-lg font-medium">{item.count}</span>
              <button
                class="px-2 py-1 rounded bg-gray-200 hover:bg-gray-300"
                onClick={() => updateCount(item.id, 1)}
              >
                +
              </button>
            </div>
          </div>
        ))
      }
    </div>
    <div
      class="flex items-center justify-between border-b-2 border-farvenavn-lilla py-2"
    >
      <div class="flex items-center space-x-2">
        <h3>Totalt</h3>
        <p>{totalCount} flasker</p>
      </div>
    </div>
  </section>

  <script>
    let items = [...Astro.props.items];
    let totalCount = items.reduce((sum, item) => sum + item.count, 0);

    function updateCount(id, delta) {
      const item = items.find((i) => i.id === id);
      if (!item) return;

      item.count = Math.max(0, item.count + delta); // Sikrer at tallet ikke går under 0
      totalCount = items.reduce((sum, i) => sum + i.count, 0);

      // Opdater UI ved at tvinge re-render
      Astro.refresh();
    }
  </script>
</MainLayout>
